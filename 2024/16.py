e = """
.|...7....
|.-.7.....
.....|-...
........|.
..........
.........7
..../.77..
.-.-/..|..
.|....-|.7
..//.|....
"""

q = """
7.........../../..7.7.7................|..-...7........./.......-.....................-...7...--....../..7....
........|............|............-.........|....7.................7-.........../...../....-../....7..........
.-....................77..................|.7..........7.........../.............................-...-........
............-.....7/...........-........-......................-..-...../...............|................/....
.......7....-...-...............|.............-...................../....-../............./7..........-..7....
..................-.............7.........7........-......./..../..|....|......-/............7.............7..
-...............|.........7........../.7........../......./-..........-...-.....-............................|
.77...7..........-............./...-|...................../.......-.................-....../.........|........
..................../........................./..7...................7.................-/......./.............
../...................|...../.-..................-.....|....-.|....................../.../7....-....|..7..|.7.
..................|..................................-....|.........7................................./.......
.........-...........-........7..|-...................--.............-.../......./....................7..-....
-..........-.................7.....|......|.7................|../..........7.........7.|.............-....7...
......./....-....|....-..........|........-...-....-.....-............................................/../....
.......7...........|.......7....7.//7.............7...../|....-...../..|....-................/................
.........7........./............7.-.|......./..........................|....7........-.-.............../..|-.|
.............................7......|....-../.....7.....-..../.........................7......|....../...7/...
.../.7.........../................................./.7.7...............7..............7.....|........-........
..................7......-......|..................7................................/.../.|...................
...77............................7./................../............................-.......-..|...............
/.............7...-....7...//..-..7....-......-.7............../.....|../.........|..../........7......7......
./..........-.........7..-.................-.|...........7.......-.......|...................|../.............
.....-./.7..../.|.............../...........|..../....7...7/..-.........|....-.........|......................
...../.|.............../.....................77../...|........7........./|-...........7/./.77.................
..............7...-..............7.|......./........-...............-.-...|..7......-./..........-.......|../.
.....|...............7....|............../................./....../...-........-.....|........7.........||../|
.../................................../...............-......................................../.......-......
......../.........|..../...............|...../..|................./............|.../.....|....|..7........-...
.../................................//-.......7........./......../....-.....-....-............................
........../....................|................................./.-......|.....7........-..............|..|..
........|...-............|.7.../.......................7...7../...........|../7.7-..../|7..|-...7......7....-.
...-.7..../.....||.....7./.-.....7..............-.......7.../...-....|......7...........-.....-....../........
...|-...|..........7.........../.......................-....../...............7.......7.....|.................
....7..../77..........-........7............................/...........|.........|......|.|...........|...|..
.............7............................../....|..7.7..../....................7..|...|..-............7....-.
.-/|./...7....-7....-...7...............-.../............-..../.--............................|||.............
....../../77...|..-.................7.............../.|7/............................../.........7.....|......
..../....................7..................../......7............-//.........................................
.............7..../........../........-..............................|...-/....../..|....|.......-......../...
................-.|..7../...|.7..|..-.....-..../...................7..............7........................./.
........................../......7...............................-..../......................-...........-....
........7.-......................./...............7..............................7...../...................7..
..............................7..|..............|7.-..-....-..|..../.........7.............../.-..............
..........................77./|.........7|7..............7......./.......-.-...................7.......-......
.............|.........-..7..................|......-..|.-|.................--..||............-.|.............
..............7..7.7.7.........-./....../7../|../.......................7-.....7....|.........................
.............................|.........7.....|..............................|.......././-.../.........-./....|
7.....................7.../..................................-......./........../..7.7.................|......
...............-......................../.....................................................................
..../........./........-.....|................/../....7.........../../.././........./......................-..
.......7................/............................................7........../..7.7......|/|7..............
...........7.............................77......77..|..-7................../.-.....................-.........
........|../..7...............|......./.................................|......|./....../......-..............
........./................7.............|...............-.........-.....7.............../.7..........|........
.........................|......./....................-......|........7.........................|/............
.7..-.......................................-....|.................................|7./.7.....................
7../................................-.-.....-..................../....../......../7...|..|......../.......7...
........................../..............7|............./..../.................../...7....7/..................
../-.........................7...7......7......................|.......7..7...7...7.................-..|....7.
....-...................7......-........../......../...............|................................/.........
.................................../......|.......|......................................|..7........-........
......|..|....-..................7./.............../.|...............|.|/.......7.7...........................
...............|...........|.....7................................................|................7.....|....
......../...|......../.................../../...........|...|............./.............7..|.../........-.....
.....................-............7...|..........|...-..........|..-..../...-...../......|....................
...7.......7.....-..................................|/.....7......|.....................|.......|......./.-...
.....................|........./...............|.-...........7........|......|...-/............../.-..........
......./....../.......-....-..............7../7.......7................................................|......
................../.......77.......................|...7........|...7........-....7..-..........7...../..-....
...............................................-.........................7................7............../..7.
....|......../.........7.........-../....-....................7..................|............................
................./.-../7..........-.....|.........7.........7..../.............................|........--/...
................|./...............|.......7....-7........-.....................-.....|..................../-..
...........7........................|../...-./......7...............7........-./......|.................|..7..
.......|-....../...........|..........|............/.............../.|....../...................7.............
...../...../..........|.......................|....................|.........7|............................7..
........-........7......./....7.............//................................./......./...................|..
..-......../...................-...../.........-...................|..........................7....../.-......
./............................7...............................|............|...../.|................|.........
......7................|.............................-.........7.................................../-........7
./-/..........|.................................../........7....7.....7.....................7.7.........|.....
.-............../../........./.........-......7.....................7..7..7..7/......-./.../....|.............
.....|..................-...7||.......7./../........................-.........................-..........7....
...-................/.|........-....................................|..7....-...7......-..|............/......
..........7...............|.|...-.............-.././...................../.../................................
.......7./............./........../..7............7............-7......|......|....|.........../|.............
............7....|...........|...............-........7..|7..-.....-...|....................7..../.......-....
........7.....7...................|......./......-........./....7-...................|................7....-..
../......................../................-...|..........7........../...................................|.7.
.....................-..../......../........./........./.........7.......|/-...........|.........7...../...../
......//..................7.|....|..|..7...7-........./...........7............/..................|...-.....7.
.....-..-....../..................7....7........................|......................../....|........7..|.7.
.........-............7..............7..7.7../............................7..-...-................./-.........
....|./..........7..-.................7..7...../.7...................-................/............|...../....
...7.................../.....-...../.-.././....-/......|..................|................/.............-....
.....7.||.................7................7..|.....|.............7.7-.............-................./........
.......7..........7....................|................/..............|.../..................7...-.-.||......
.....-./..7.7.........................................|......./.............../....|..|.......-........7...7..
.....|............./.....-...................|.7..../-............7.........................-................7
........7/............./......7......|-...|................../.....|-......................./..............7-.
..............-..../.....-..........||.-.....-.../................././.../............7/................./../.
-.....................................|.........-.....|...................|..................../.../..........
.......................-..|................/...........7...........................|.--.....7..........|/..-..
...............7..................../..../.|..........................|.....................|..7...7....--....
....../.......-...............................|....../.........7.-........../.....................7.--...-....
.-......7............/...-........|.....7........../|........................|..........7...|....../-.........
/............................../.....................................7........../|........-...............7..-
.........7........7.|.|7..7.....-..............-.........-...........|........|...|...........-.............||
.-7................7.......|...................................../..................-.-.....|...7..7.|........
7............-/../.......|............./......77.7./.|......-/.7.7.............7........./|7.....-............
"""

import sys
sys.setrecursionlimit(10000)
def f2(x: str):
    x = x.strip("\n").splitlines()
    x = list(map(list, x))

    almanac = dict()

    def in_range(y):
        posr, posc = y
        return posr in range(0, len(x)) and posc in range(0, len(x[0]))
    
    def num_energized(start, seen, level):
        # print("---", start)
        # print("num_energized: start", start)
        if start in almanac:
            # print("num_energized: Returning!", start)
            return almanac[start]
        
        elif not in_range(start[0]):
            almanac[start] = (set(), set())
            return (set(), set())
        
        def get_next_pos(curr):
            pos, dire = curr
            key = x[pos[0]][pos[1]]
            up = ((pos[0] - 1, pos[1]), "^")
            down = ((pos[0] + 1, pos[1]), "v")
            right = ((pos[0], pos[1] + 1), ">")
            left = ((pos[0], pos[1] - 1), "<")
            if key == ".":
                next_pos = {
                    ">": [right],
                    "<": [left],
                    "^": [up],
                    "v": [down]
                }
            if key == "7":
                next_pos = {
                    ">": [down],
                    "<": [up],
                    "^": [left],
                    "v": [right]
                }
            if key == "/":
                next_pos = {
                    ">": [up],
                    "<": [down],
                    "^": [right],
                    "v": [left]
                }
            if key == "|":
                next_pos = {
                    ">": [up, down],
                    "<": [up, down],
                    "^": [up],
                    "v": [down]
                }
            if key == "-":
                next_pos = {
                    ">": [right],
                    "<": [left],
                    "^": [right, left],
                    "v": [right, left]
                }
            import pprint
            # pprint.pprint(almanac)
            # print(next_pos[dire], key, curr)
            return next_pos[dire]
    
        next_pos = get_next_pos(start)

        excited = {start[0]}
        exex = {start}
        for pos in next_pos:
            # print(level, next_pos)
            if pos in seen:
                # print(pos, level)
                if pos in almanac:
                    excitedc, exexc = almanac[pos]
                    excited = excited.union(excitedc)
                    exex = exex.union(exexc)
                continue
            # ans = num_energized(pos, seen, level + 1)
            # if pos == ((0,2),"<"): print("!",level)
            seen.add(pos)
            excitedc, exexc = num_energized(pos, seen, level + 1)
            # print(excitedc)
            excited = excited.union(excitedc)
            exex = exex.union(exexc)
        
        almanac[start] = (excited, exex)
        import pdb
        # pdb.set_trace()
        return almanac[start]

    # res = num_energized(((0, 3), "v"), set(), 1)
    # for seen in res[0]:
    #     x[seen[0]][seen[1]] = "#"

    # import pprint
    # pprint.pprint(x)
    # return len(res[0])
    maxval = 0
    for row in range(len(x)):
        for col in range(len(x[0])):
            for direc in "<>v^":
                start = ((row, col), direc)
                # if start == ((0,1),"<"):
                #     print("!!!!!!!!")
                #     print(almanac[((0,1),"<")])
                res = num_energized(start, set(), 0)
                val = len(res[0])

                # if start == ((0,1),"<"):
                #     for seen in res[0]:
                #         x[seen[0]][seen[1]] = "#"

                #     import pprint
                #     pprint.pprint(x)
                # print(val)
                maxval = max(maxval, val)
    return maxval
    

print(f2(e))
# print(f2(q))