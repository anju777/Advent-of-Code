e = """
...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........
"""

q = """
...................................................................................................................................
..#....#..............#.................#......#...................................##...............#.......#....#..#...#..........
.............#.#.........#....#...#...............#........#.............................##..#...#......#.............#.........#..
...................................#.#......#....#......##....................##...#.#.#....#......#....#.........#.........#.#.#..
........#..........................................................................................#.....##......#......#.......#..
..#...........#......#.............#.........................................#.....#...............#..#.....#.............#....#...
..#................#..................................#...................................##...............#........#.........#....
...................#....#........#..#....#...........#..........................................#.#................#...........#...
.#......#............#.....##.#...#.............................................#..#......#......#..#..............................
........................#...#..#.......#..#..................#.................#............#..#........#......#...#.....#.#.......
..............#...#................#..#............#........#...................#.....................#....#.......................
........#.#........#...#.#...#...#..#..#..#.#.............#..#................................#..........................#.........
..............#..#..#........#.......#..##...#...........#.....#..................#.....#.................#........#.....#...#.....
..#...........##...........#.......................................#.#..................#..#.................................#.....
.......................#.#...........#.....#...........#.......#.......#.#............##..#..#......................#..............
..#.........#.......#........#.#.#.#.#...#................#.......#...#................#...#...................#............#......
.#.....#........#..............#....#..............................#.#....#..............#....#.................#....#..#..........
................#..#..#.......................................#.#..........#.#.......................#.#.......#...#.............#.
.#...#......#....#.........................#...................##.....#......................#.........#........#.#.#....#...#.....
..#.....................##..........#........................#.................................#..#..........###................##.
.................#....#........#...#..#......................................#..................#.#....#.#.....#...##.##...##..#...
........#....##..#.................................................#..#......................#............#.......#.#......##..#...
.................#....................#...............#...#...#...#....#......#..............##..........#........#...........#....
.......##......#..................##..#........##.....#.#..#................#................#......#......#.#...............#.....
..............#...............................#.........#..............................................#.....#......#......#.#.#...
.#......#...........................#.........#..#...........#.....#..#.#..#............................................#..#.......
.#.....#...##..............#.#..#.................#...##..#.......#...................#........#.......#..................###......
.#...#.....................#.........................#....#.........#.......#...........................#.......#....##.#..#.......
....#.....................#......................#........................#.................................#....#.....#...##..##..
...#...#.........#............#..............##...#...............#......................#.........#...............#...........#...
........................#........................#.......#....#.............#....#......##................#.......#..#.......###...
.......#.........#.#....................#...................#.....##.........#.......................#....#....#......###..........
...................#...#.....#..................##......#................##...#......................#.#........#..................
...#.....#.....#.#...#..#...........#.....##.........#......#....................#...........................#.....................
..#........#....#.......#........................#............##.............#.....#....................#...#........#.............
............#..........#.................#.###..........................##.....#..#....#...#..#..............#.##..................
.#............#......#............#..................................###.................#.#.......................................
.#.#..#.......#.#..#............................#...................................................................#....#.....#...
................##.#................................................#..........................................#...#...............
.#.....#.##........#..........................#.#..............#......#...........#.......#.......#..........#.#...##........#.....
................#..#................#..................#..##........#..................#......................#..............#...#.
........#.....#....#............#........#...#............#.#.#.....#...........#.#....#...........................................
.#........#.......#..........................................##....#.#.............#.............#....#............#.............#.
.#....#........#......................#...........#....#.............................................#...............#......#......
................#............#.......#.............#............#.............#.....##...............#..................#...#......
.#..#....#..#.#.........#...#...........#.......................#..............#....#............#....#..#.................#.......
....#..........................#.....#......#..................##..............#.........##..#............................#........
....#.....................................#..#..............#..#........................................#..........................
.....#...............#...........#..#.........#........#.....#...................................#...................#.............
.........#...................#....#........#........................................#.........#..#.#....................#.....#....
....................#...................................#....#...................#.......#............#......#.....................
......................#.................#..#...###.....#..#.......#..#...#..........#....#...#..#....#......................#......
..................#.##.................#....#...#...........##....................#....#.............#.......#..................#..
.......#........#.....#..#.....................#.....................#...........#..........#.......#.............#..........#.....
.##................###.........##........###.........#.#....#..............#..#..............#..............................#......
....#..............##..........#.............#....#................................#.............#............#.#...........#......
...................#.#.......#.....#...#...............#..........#......#.#........#....#.......#.................................
........................#............................#.#...........#..........#................#......#...#.#.................#....
...#..........................................#...#.................................#...................#...#........#...........#.
..............#................#...#.......#....................#...#..............#........#....##.#.......#......................
................#..#.#.......#.#........#.........#...#......#....................................#..............#..#............#.
........#..#........#.##..##..................#...#.......................#.#..........................#................##.........
..............................#.....#...#................#.............#.............#...#..........................#..............
.......#.....#.........#............##...............#..........................#......#.#..#.......#....#..#.......#..#...........
...........................#................#........#..............#....#............#..................................#..#......
.................................................................S.................................................................
.....#........#..##..........#..#...#..........#.#...........#.#....#..........##........#..........#..#.......#..#................
.......#......#......#...#...........#.##......#...#......#..........................#.......#.....................................
...........................#.............#......#..........#.#.....#..................##..........#...................#............
........#.............##......#...#......................##...#........#..........................#............#...................
......................#...#....#..#.##...#..#....#............##........................#..............#..#........#..##...........
...............................................#......#...........................#...#............#.....#........#................
............#..........#.....#.....#........#...........#................#......#...####......#.........#.......................#..
.............#........#..#.#..........#.##...#.#..#....#..........................#...#..#...###...................#............#..
..............#..#...........#.............#.#...#......................#..........................................................
..............#..........#..#.......#.........................#.#......#...#..................#..#......#..........................
................#.........#...........#............#........#.#.#....................................#.............................
........................#...#..#..#....#...................#...........#..................##.....#..............#................#.
.#......##...........#...#.............##........#..........#..........#...#...#.#......#.#....#...##........##....................
.......................##...#......#......#....#.............#.....#..............#.....................#.....#.........#...#..#.#.
.................................#..#....#....##...................#......#...#..............................##....................
...#......##..........#.............#.#....#................#...#............#.........#..#................###...........#..#......
.#..........#.........#....##.#....#......##.#....#.#...........#...##........#............#....#.#...#.#.....................#....
..#........#.................#.#...........................#...............#........#.....#.#...............#........#.#...........
..#...........#..........#....#..#............................#........#............................#..#..................##.......
...........##..............................#..##.......................##...#....................#.................................
...........................#......##...#.....#..............#...#....#................#...#.....##...............#......#..........
.......#..#...#................#...#...........#........#.#.#..................#..............#...#.....................##.........
.................#.#.....................#.#.............#..............................#......#.......#.......#......##.....#.....
............#.......#..............#........#..#......#..#................................#...#.....#.#..........#......#......#...
...................#...............................................#..............#........#.#..................##..............##.
...#..............................#.........#................#................#.#...#.......#.....#.........#......................
.#.#.#...............#...................##......#......................#............#........................#.......#........#...
......#.....#....#......#..........#...#...##.............#.#..............................#.#..#...........#......##..............
....................#...#........#..#..#....#................................#.......#..#..##..................#.........#.........
.......#...#.........#..............#................#...#.........#......................................#..........#...#.#.....#.
..##..#.....................................#.....#........#....#.....#....................................#..........#.........##.
.#.........................................##....#.........................#..#.........#.............#.......###..................
...........#...##..................................##..#....#.......#....#..#.......#......................#......#.#.#...#........
...........#...#.......................#....#..##..................#............#.#...##....#.......................###............
..........#......##........................#........#.......#......#................................#..............................
...................##....#..#................#........................#...#....#....#....#........#..........#.....#....#..........
.......................#.....#...................#...#...#..#.............#.#..................................#..#...#..........#.
.................#.....................................................#.#.........................#........................#......
................#..........#.........................#.##.##...........#.................................#.........#..#............
....##....##......##.....#....................#......#..........#..........................................#...#..........##.......
...#..........#..........#..........#............##...#...#.#...................#...#.............#.......#....................#...
.....#........#.........#............................#..#.#............#.....#...............#..........#...#..................#...
...............#...#.#...#.......#........................#........................................#......#..............#.........
.....#.#............#.....#.....................................#....#...##.................................#....#..#..#.....#.#...
....#...#..#.....#...................#..#...................#.....#...#......#.....................#.....#....#.#.....##..##.......
.........................#........................#....#..#.#......#.....#.................................#.........#...#.........
.....#.............#......................#.........#......................................#........................#..#.#.#.....#.
.........#.#.......................#.#..#...........#.##......#.............#......................................#.....#....###..
.............#...................#...#.................#.#......#....#.....#.#..........#.....#....#...#.#......#...#...##....#..#.
......##......#.................#..#....................#....#..#.......#...................##......#.......#....#...#...#.#.......
..#....#........##.......##.#...#...........................#.......................#.....#...#.......##..................#........
.....#...........#.#...............#.#......#..#..........#..#....................................##......#..........#...#..#...#..
.#....................##...#.............................##.....#.................#........###...........#...#..................#..
.....#..#....#...#....#........#..#..#.....#....................................#......#....#.##.........#.....................#...
.......#............#................#......#.#....................#...#.................#.............#.......##.#................
..#.....#..............#........................#............#........#..........#..............#..##.....#.#........##......#..#..
..........#.............#................#...................#..............................#......#...............................
....#....................#.#....#................#.##.......................#......................#.....................#....#....
..#...#................##..#.........#.............#..#.........#............................#.......#........#...#.......#....##..
....#..#.................#....#................................................#...........#.......#...........#..............#....
...#...#................#...........#........#..#...#....................#........#.....##...........#.#...........##.....#.....##.
...........#.....#..#........#.....#..........#.#......#.#........................................#...#.....................#......
............................#........##..........#......................................................#........#....#.#...#.#....
..#..#.........#.#..........#.........#.........#............................#..#....#......##..#......#..............#............
...................................................................................................................................
"""

import numpy as np

def make_map(x: str):
    """Create a map from input string x"""
    a = []
    for line in x.strip("\n").splitlines():
        # Replace all elements with numbers
        line = line.replace(".", "0")
        line = line.replace("#", "1")
        line = line.replace("S", "5")
        
        # Make it into a list
        line = list(line)

        # Make all elements into int
        line = list(map(int, line))

        # Make it into a numpy array
        a.append(np.array(line))

    return np.array(a)

def f(x):
    TOTAL_STEPS = 100
    PART2 = True

    curr_step = 0
    visited = set()
    evens_visited = set()
    odds_visited = set()
    num_steps_to_conquer = None
    spots_conquered = 0

    x = make_map(x)
    maxloc = np.argmax(x)
    startx, starty = maxloc // len(x), maxloc % len(x)
    options = [(startx, starty)]

    def modit(spot):
        return (spot[0] % len(x), spot[1] % len(x[0]))

    def take_steps(pos):
        ret = [(pos[0] - 1, pos[1]), (pos[0] + 1, pos[1]),
               (pos[0], pos[1] - 1), (pos[0], pos[1] + 1)]
        orig_ret = ret.copy()

        ### Part 1 ###
        # for elem in orig_ret:
        #     if elem[0] < 0 or elem[0] >= len(x):
        #         ret.remove(elem)
        #     elif elem[1] < 0 or elem[1] >= len(x[0]):
        #         ret.remove(elem)
        #     elif x[elem] == 1:
        #         ret.remove(elem)
        #     elif elem in visited:
        #         ret.remove(elem)
        #############

        ### Part 2 ###
        for elem in orig_ret:
            if x[modit(elem)] == 1:
                ret.remove(elem)
            elif elem in visited:
                ret.remove(elem)
        #############

        # print(f"From {pos}, can take steps {ret}")
        return ret
    
    def print_map(highlight_pos):
        m = x.copy()
        for pos in highlight_pos:
            m[pos] = 7
        print(m, end="\n\n")

    while curr_step <= TOTAL_STEPS:
        # Adds elements to visited
        # print()
        # print(f"Step {curr_step}: options are {options}")
        if curr_step % 2 == 0:
            if not num_steps_to_conquer and set(options).issubset(evens_visited):
                num_steps_to_conquer = curr_step
                spots_conquered = len(evens_visited)
            evens_visited = evens_visited.union(set(options))
        else:
            if not num_steps_to_conquer and set(options).issubset(evens_visited):
                num_steps_to_conquer = curr_step
                spots_conquered = len(odds_visited)
            odds_visited = odds_visited.union(set(options))
        visited = visited.union(set(options))

        next_options = []
        for option in options:
            next_options_subset = take_steps(option)
            next_options.extend(next_options_subset)
            visited = visited.union(set(next_options_subset))
        
        options = next_options

        curr_step += 1
    
    print(f"It takes {num_steps_to_conquer} steps to conquer {spots_conquered} spots")
    # return spots_conquered * ((TOTAL_STEPS / num_steps_to_conquer) ** 2)

    if TOTAL_STEPS % 2 == 0:
        # print("Final map highlighting all possible locations")
        # print_map(evens_visited)
        return len(evens_visited)
    else:
        return len(odds_visited)

class Cache:
    def __init__(self, point, step, visited):
        self.point = point
        self.step = step
        self.visited = visited


def f2(x):
    TOTAL_STEPS = 100

    curr_step = 0
    visited = set()
    evens_visited = set()
    odds_visited = set()
    num_steps_to_conquer = None
    spots_conquered = 0

    x = make_map(x)
    maxloc = np.argmax(x)
    startx, starty = maxloc // len(x), maxloc % len(x)
    options = [(startx, starty)]
    cache_map = {}
    for i in range(len(x)):
        for j in range(len(x[0])):
            


print(f(e))